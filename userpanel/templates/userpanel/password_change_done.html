{% extends 'userpanel/user_base.html' %}
{% load static %}

{% block title %}Password Changed{% endblock %}

{% block content %}
<main class="request-form-container">
    <!-- Display messages if any -->
    {% if messages %}
        <div class="messages-container">
            {% for message in messages %}
                <div class="alert alert-{{ message.tags }}" id="successAlert">
                    <i class="fas fa-{% if message.tags == 'success' %}check-circle{% elif message.tags == 'error' %}exclamation-circle{% elif message.tags == 'warning' %}exclamation-triangle{% else %}info-circle{% endif %}"></i>
                    {{ message }}
                </div>
            {% endfor %}
        </div>
    {% else %}
        <div class="success-message" id="successMessage">
            <i class="fas fa-check-circle"></i>
            <h1>Password Changed Successfully</h1>
            <p>You can now access other pages. Redirecting to dashboard in <span id="countdown">3</span> seconds...</p>
            <div class="actions">
                <a href="{% url 'user_dashboard' %}" class="btn-return">Return to Dashboard</a>
            </div>
        </div>
    {% endif %}
</main>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // If messages are displayed, wait a moment before redirecting
        const successMessage = document.getElementById('successMessage');
        let countdown = 4; // Increased to 4 seconds to give time to read the message
        
        const countdownElement = document.getElementById('countdown');
        
        const timer = setInterval(function() {
            countdown--;
            if (countdownElement) {
                countdownElement.textContent = countdown;
            }
            
            if (countdown <= 0) {
                clearInterval(timer);
                window.location.href = '{% url "user_dashboard" %}';
            }
        }, 1000);
    });
</script>

<style>
.request-form-container {
    max-width: 600px;
    margin: 2rem auto;
    padding: 2rem;
    background: white;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    text-align: center;
}

.success-message {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 1.5rem;
}

.success-message i {
    font-size: 4rem;
    color: #4caf50;
}

.success-message h1 {
    color: #333;
    font-size: 1.75rem;
    margin: 0;
}

.success-message p {
    color: #666;
    font-size: 1.1rem;
    margin: 0;
}

.actions {
    margin-top: 2rem;
}

.btn-return {
    background-color: #1976d2;
    color: white;
    padding: 0.75rem 1.5rem;
    border-radius: 4px;
    text-decoration: none;
    font-weight: 500;
    transition: background-color 0.2s;
}

.btn-return:hover {
    background-color: #1565c0;
}

.messages-container {
    margin-bottom: 2rem;
}

.alert {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 1rem;
    border-radius: 4px;
    font-weight: 500;
}

.alert i {
    font-size: 1.25rem;
}

.alert-success {
    background-color: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
}

.alert-success i {
    color: #28a745;
}
</style>
{% endblock %}